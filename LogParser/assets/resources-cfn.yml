Parameters:
    DeploymentStage:
      Description: Deployment name (e.g. production, stage)
      Type: String
      Default: dev
    LogGroupName:
      Description: The name of the log group
      Type: String
      Default: '/lambda-sharp/log-parser/dev'
    LogStreamName:
      Description: The name of the log stream
      Type: String
      Default: test-log-stream

Resources:
  # CLOUDWATCH LOG GROUP 
  CloudWatchLogGroup:
    Type: "AWS::Logs::LogGroup"
    Properties: 
      LogGroupName: 
        Ref: LogGroupName
      RetentionInDays: 1
    
  # CLOUDWATCH LOG STREAM
  CloudWatchLogStream:
    Type: "AWS::Logs::LogStream"
    Properties: 
      LogGroupName: 
        Ref: CloudWatchLogGroup
      LogStreamName: 
        Ref: LogStreamName
  
  LambdaSharpLogParserRole:
    Type: "AWS::IAM::Role"
    Properties: 
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement: 
          -
            Effect: Allow
            Principal: 
              Service: 
                - lambda.amazonaws.com
            Action: 
              - sts:AssumeRole
      ManagedPolicyArns:
        - arn:aws:iam::aws:policy/AWSLambdaFullAccess
      RoleName: LambdaSharpLogParserRole
